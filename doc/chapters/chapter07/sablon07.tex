% Szglab4
% ===========================================================================
%
\chapter{Prototípus koncepciója}

\parindent 0pt
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}
\thispagestyle{fancy}

\section{Prototípus interface-definíciója}
\comment{Definiálni kell a teszteket leíró nyelvet. Külön figyelmet kell fordítani arra, hogy ha a rendszer véletlen elemeket is tartalmaz, akkor a véletlenszerűség ki-bekapcsolható legyen, és a program determinisztikusan is tesztelhető legyen.}

\subsection{Az interfész általános leírása}
\comment{A protó (karakteres) input és output felületeit úgy kell kialakítani, hogy az input fájlból is vehető legyen illetőleg az output fájlba menthető legyen, vagyis kommunikációra csak a szabványos be- és kimenet használható.}

\subsection{Bemeneti nyelv}

\subsubsection{Felhasználói parancsok}

A parancsokat a standard bemenetről, illetve fájlból olvassa be a program. Minden parancsot egy sorvége karakter zár le.\newline
Megjegyzés: minden parancs ad visszajelzést a felhasználónak a végrehajtott eseményről, ennek formátuma a Kimeneti nyelv c. fejezetben olvasható.\newline

\textbf{loadCircuit [file]}
\begin{itemize}
	\item Leírás: A megadott áramkört betölti a szimulációs program.
	\item Megjegyzés: A file nevét kiterjesztés nélkül kell megadni.
	\item Opciók: -
\end{itemize}

\textbf{loadSettings [file]}
\begin{itemize}
	\item Leírás: A jelenlegi áramkörhöz a megadott konfigurációs fájl betöltése.
	\item Megjegyzés: A file nevét kiterjesztés nélkül kell megadni.
	\item Opciók: -
\end{itemize}

\textbf{saveSettings [file]}
\begin{itemize}
	\item Leírás: A pillanatnyilag használt konfiguráció fájlba mentése.
	\item Megjegyzés: A file nevét kiterjesztés nélkül kell megadni.
	\item Opciók: -
\end{itemize}

\textbf{switch [név]}
\begin{itemize}
	\item Leírás: A megnevezett kapcsoló átállítása.
	\item Opciók: -
\end{itemize}

\textbf{setSeqGen [név] [érték1, érték2, ...]}
\begin{itemize}
	\item Leírás: A megnevezett szekvenciagenerátor az értékparaméterek szerint beállítódik.
	\item Opciók: -
\end{itemize}

\textbf{getValue [név]}
\begin{itemize}
	\item Leírás: A megadott áramköri elem kiírja az aktuális kimeneti értékét.
	\item Opciók: a getValue -all parancs az összes áramköri elem kimenetének értékét kilistázza.
\end{itemize}

\textbf{step}
\begin{itemize}
	\item Leírás: A parancs hatására lefut egy szimulációs ciklus, melynek két eredménye lehet:
	\begin{itemize}
		\item véges lépésen belül stabilizálódik a rendszer, ekkor a kapcsoló(k), szekvenciagenerátor(ok) és kijelző(k) értéke(i) kiíródnak.
		\item nem stabilizálódik az áramkör; hibaüzenet
	\end{itemize} 
	\item Opciók: -
\end{itemize}

\subsubsection{Konfigurációs fájlok nyelvtana}
A konfigurációs fájlok *.ovr kiterjesztésűek, ezekben adjuk meg a szimulálandó hálózat paramétereit. Egyszerű szövegfájl, melyben az értelmezendő parancsok soronként tagolódnak. A program feltételezi a konfigurációs fájl hibamentességét, sehol nem ellenőrizzük, hogy a bemenetnek van-e értelme!\linebreak
A fájl létrehozásához az alábbi parancsok, szintaxisok állnak rendelkezésre:

\begin{itemize}
\item X=...
	\begin{itemize}
	\item Leírás: komponens létrehozás. Ezzel a paranccsal az egyenlőség jel után megadott komponenst hozzuk létre, melynek kimenetére ezek után az "X"-el hivatkozhatunk. Amennyiben több kimenetű komponensről beszélünk akkor az egyenlőség bal oldala egy tömböt jelent. Ebben az esetben az egyes kimenetekre a későbbiekben X[i]-vel hivatkozhatunk (a 0 és N-1 között).
	\item Opciók: A lehetséges komponensek az implementált komponensek listájából választható, melyeknek paraméterül az egyes komponensekhez tartozó meghatározott paramétereket át kell adni.
		\begin{itemize}
			\item OR(...)			%+
			\item AND(...)			%+			
			\item INVERTER(...)		%+			
			\item VCC(...)			%+
			\item GND(...)			%+
			\item MPX(...)			%+
			\item FFJK(...)			%
			\item FFD(...)			%
			\item LED(...)			%+
			\item 7SEG(...)			%
			\item TOGGLE(...)		%+
			\item SEQ(...)			%+
			\item WIRE(...)			%+
			\item NODE(...)			%+
		\end{itemize}
	\end{itemize}

\item OR(name,WIRE[n])
	\begin{itemize}
	\item Leírás: vagy kapu létrehozása.
	\item Opciók: 
		\begin{itemize}
			\item name: meg kell adni a kapcsoló nevét (egyedi azonosításra szolgál - a külvilág felé).
			\item WIRE[n]: fel kell sorolni a kapu bemenetére kötött WIRE típusú változók neveit. N bemenetű kapu esetén ide N db WIRE kerül. A kapu számot nem kell megadni, azt a parser autómatikusan észleli a megkapott paraméterek számából. Minimum 2 bemenetet meg kell adni.
		\end{itemize}
	\item Példa: OR(vagy1,w\_kapcs1\_vagy1,w\_kapcs2\_vagy1,w\_kapcs3\_vagy1) - három vezeték rákapcsolása a kapura, mely így egy három bemenetes vagy kapu lesz.
	\end{itemize}

\item AND(name,WIRE[n])
	\begin{itemize}
	\item Leírás: "és" kapu létrehozása.
	\item Opciók: 
		\begin{itemize}
			\item name: meg kell adni a kapu nevét (egyedi azonosításra szolgál - a külvilág felé).
			\item WIRE[n]: u.a. mint a vagy kapu esetén.
		\end{itemize}
	\item Példa: AND(es1,w\_kapcs1\_es1,w\_kapcs2\_es1) - két vezeték rákapcsolása a kapura, mely így egy két bemenetes vagy kapu lesz.
	\end{itemize}
	
\item INV(name,WIRE\_in)
	\begin{itemize}
	\item Leírás: inverter létrehozása.
	\item Opciók: 
		\begin{itemize}
			\item name: meg kell adni a kapu nevét (egyedi azonosításra szolgál - a külvilág felé).
			\item WIRE\_in: az inverter bemeneti vezetékét kell megadni. Csak egy bemenetű inverter létezik.
		\end{itemize}
	\item Példa: INV(inv1,w\_kapcs1\_inv1) - egy vezeték rákapcsolása a kapura.
	\end{itemize}
	
\item VCC(name)
	\begin{itemize}
	\item Leírás: konstans igaz jel létrehozása.
	\item Opciók: 
		\begin{itemize}
			\item name: meg kell adni a komponens nevét (egyedi azonosításra szolgál - a külvilág felé).
		\end{itemize}
	\item Példa: VCC(vcc1)
	\end{itemize}
	
\item GND(name)
	\begin{itemize}
	\item Leírás: konstans hamis jel létrehozása.
	\item Opciók: 
		\begin{itemize}
			\item name: meg kell adni a komponens nevét (egyedi azonosításra szolgál - a külvilág felé).
		\end{itemize}
	\item Példa: GND(gnd1)
	\end{itemize}	

\item MPX(name,WIRE\_in[4],WIRE\_S[2])
	\begin{itemize}
	\item Leírás: 4:1 multiplexer létrehozása.
	\item Opciók: 
		\begin{itemize}
			\item name: meg kell adni a komponens nevét (egyedi azonosításra szolgál - a külvilág felé).
			\item WIRE\_in[4]: meg kell adni négy WIRE-t, ami az egyes bemeneteket jelentik.
			\item WIRE\_S[2]: meg kell adni két WIRE-t, ami a két select jelet adja
		\end{itemize}
	\item Példa: MPX(mpx1,w\_in3,w\_in2,w\_in1,w\_in0,w\_s1,w\_s0)
	\end{itemize}	
	
\item FFJK(name,WIRE\_clk,WIRE\_J,WIRE\_K)
	\begin{itemize}
	\item Leírás: konstans hamis jel létrehozása.
	\item Opciók: 
		\begin{itemize}
			\item name: meg kell adni a komponens nevét (egyedi azonosításra szolgál - a külvilág felé).
			\item WIRE\_clk: meg kell adni egy WIRE-t, ami az órajel bemenet lesz
			\item WIRE\_J: meg kell adni egy WIRE-t, ami az J bemenet lesz
			\item WIRE\_K: meg kell adni egy WIRE-t, ami az K bemenet lesz			
		\end{itemize}
	\item Példa: FFJK(ffjk1,w\_clk,w\_j,w\_k)
	\end{itemize}

\item FFD(name,WIRE\_clk,WIRE\_D)
	\begin{itemize}
	\item Leírás: D flip-flop létrehozása.
	\item Opciók: 
		\begin{itemize}
			\item name: meg kell adni a komponens nevét (egyedi azonosításra szolgál - a külvilág felé).
			\item WIRE\_clk: meg kell adni egy WIRE-t, ami az órajel bemenet lesz
			\item WIRE\_D: meg kell adni egy WIRE-t, ami az adat bemenet lesz
		\end{itemize}
	\item Példa: FFD(ffd1,w\_clk,w\_d)
	\end{itemize}
	
\item LED(name,WIRE\_in)
	\begin{itemize}
	\item Leírás: LED létrehozása.
	\item Opciók: 
		\begin{itemize}
			\item name: meg kell adni a komponens nevét (egyedi azonosításra szolgál - a külvilág felé).
			\item WIRE\_in: meg kell adni egy WIRE-t, ami a LED bemenete lesz
		\end{itemize}
	\item Példa: LED(led1)
	\end{itemize}

\item 7SEG(name,WIRE\_D[8])
	\begin{itemize}
	\item Leírás: 7 szegmenses kijelző létrehozása.
	\item Opciók: 
		\begin{itemize}
			\item name: meg kell adni a komponens nevét (egyedi azonosításra szolgál - a külvilág felé).
			\item WIRE\_D[8]: meg kell adni nyolc WIRE-t, ami a sorra a szegmenseket kapcsolja
		\end{itemize}
	\item Példa: 7SEG(7seg1,w\_d7,w\_d6,w\_d5,w\_d4,w\_d3,w\_d,w\_d2,w\_d1,w\_d0)
	\end{itemize}
	
\item TOGGLE(name)
	\begin{itemize}
	\item Leírás: kapcsoló létrehozása.
	\item Opciók: 
		\begin{itemize}
			\item name: meg kell adni a kapcsoló nevét (egyedi azonosításra szolgál - a külvilág felé).
		\end{itemize}
	\item Példa: TOGGLE(kapcs1)
	\end{itemize}		

\item SEQ(name,BITMINTA)
	\begin{itemize}
	\item Leírás: szekvencia generátor létrehozása.
	\item Opciók: 
		\begin{itemize}
			\item name: meg kell adni a komponens nevét (egyedi azonosításra szolgál - a külvilág felé).
			\item BITMINTA: meg kell adni egy sorozatot, melyet a generátor egymás után kiad magából.
		\end{itemize}
	\item Példa: SEQ(seq1,011000110)
	\end{itemize}

\item WIRE(name,WIRE\_in)
	\begin{itemize}
	\item Leírás: vezeték létrehozása.
	\item Opciók: 
		\begin{itemize}
			\item name: meg kell adni a vezeték nevét (egyedi azonosításra szolgál - a külvilág felé).
			\item WIRE\_in: meg kell adni egy NODE-ot, vagy egy komponens kimenetet a vezeték bemenetének 
		\end{itemize}
	\item Példa: WIRE(w1,X) - WIRE(w1,Node)
	\end{itemize}	

\item NODE(name,WIRE\_in,out)
	\begin{itemize}
	\item Leírás: csomópont létrehozása.
	\item Opciók: 
		\begin{itemize}
			\item name: meg kell adni a csomópont nevét (egyedi azonosításra szolgál - a külvilág felé).
			\item WIRE\_in: meg kell adni egy WIRE-t a csomópont bemenetének 
			\item out: meg kell adni, hogy a NODE-nak hány kimenete lesz
		\end{itemize}
	\item Példa: NODE(n1,w1,3) - három kimenetű elosztót hoz létre a w1 vezeték alapján
	\end{itemize}
	
\item Példa áramkör konfigurációs fájl
Egy olyan minta hálózatot hozunk létre melyben található két kapcsoló egy és kapura kötve és az és kapu kimenete egy inverteren keresztül egy ledre kapcsolódik.
	\begin{itemize}
	\item t1=TOGGLE(t1)
	\item t2=TOGGLE(t2)
	\item w\_t1\_es1=WIRE(w\_t1\_es1,T1)
	\item w\_t2\_es1=WIRE(w\_t1\_es1,T2)
	\item es1=AND(es1,w\_t1\_es1,w\_t2\_es1)	
	\item w\_es1\_inv1=WIRE(w\_es1\_inv1,es1)	
	\item inv1=INV(inv1,w\_es1\_inv1)
	\item w\_inv1\_led1=WIRE(w\_inv1\_led1,inv1)
	\item led1=LED(led1,w\_inv1\_led1)
	\end{itemize}	


\end{itemize}

\subsubsection{Konfigurációs fájl nyelvtana}

A konfigurációs fájlban minden sorban egybeállításnak kell szerepelnie, mely a kövekező egységekből áll:
\begin{itemize}
	\item az elem neve
	\item egyenlőségjel
	\item az elem értéke (szekvencia generátor esetében több érték is lehet, ezeket vesszővel elválasztva kell megadni
\end{itemize}

példa:
\begin{verbatim}
toggle1=0
seqGen1=0,1,1,0,1
\end{verbatim}

\subsection{Kimeneti nyelv}

A program történései, visszajelzése a standard kimeneten jelennek meg, illetve ezek fájlba is kiíródnak. A program minden parancs után visszajelzést ad a felhasználónak a végrehajtott eseményről. A fentebb definiált parancsokra a következő jelzéseket kapja a felhasználó:\newline

\textit{loadCircuit [file]}\newline
Lehetséges kimenetek
\begin{itemize}
	\item áramkör betöltése sikeres
	\begin{itemize}
		\item Leírás: a betöltés sikeres, amennyiben az áramkört tartalmazó fájl szintaktikája megfelel a Konfigurációs fájlok nyelvtana c. fejezetnek.
	\end{itemize}
	\item áramkör betöltése sikertelen: hibás áramkör
	\begin{itemize}
		\item Leírás: a betöltés sikertelen, amennyiben az áramkört tartalmazó fájl szintaktikája nem felel meg a Konfigurációs fájlok nyelvtana c. fejezetnek.
	\end{itemize}
\end{itemize}

\textit{loadSettings [file]}\newline
Lehetséges kimenetek
\begin{itemize}
	\item értékek mentése sikeres
	\begin{itemize}
		\item Leírás: a konfigurációs értékek sikeresen fájlba mentődtek.
	\end{itemize}
\end{itemize}

\textit{saveSettings [file]}\newline
Lehetséges kimenetek
\begin{itemize}
	\item értékek betöltése sikeres
	\begin{itemize}
		\item Leírás: az értékek betöltése sikeres, amennyiben a konfigurációs fájlban szereplő áramköri elemek megfeleltethetők az aktuális áramkörben szereplő elemekkel, illetve a megadott értékek helyesek.
	\end{itemize}
	\item értékek betöltése sikertelen: hibás értékek
	\begin{itemize}
		\item Leírás: az értékek betöltése sikeres, amennyiben a konfigurációs fájlban szereplő áramköri elem nem feleltethető meg az aktuális áramkörben szereplő elemek egyikével sem, illetve ha valamelyik érték helytelen.
		\item Megjegyzés: azon elemek, melyek beállítására nem volt információ a konfigurációs fájlban automatikusan nullázódnak.
	\end{itemize}
\end{itemize}

\textit{switch [név]}\newline
Lehetséges kimenetek
\begin{itemize}
	\item ~[elem]: [érték]
	\begin{itemize}
		\item Leírás: az [elem] megadja a módosított kapcsoló nevét, míg az [érték] megmutatja, hogy milyen értékre változott az aktuális kapcsoló kimenete. 
	\end{itemize}
\end{itemize}

\textit{setSeqGen [név] [érték1, érték2, ...]}\newline
Lehetséges kimenetek
\begin{itemize}
	\item ~[elem]: [érték1, érték2, ...]
	\begin{itemize}
		\item Leírás: az [elem] megadja a módosított generátor nevét, míg az [érték1, érték2, ...] megmutatja, hogy milyen értékekre változott az aktuális generátor kimenete. 
	\end{itemize}
\end{itemize}

\textit{getValue [név]}\newline
Lehetséges kimenetek
\begin{itemize}
	\item ~[elem]: [érték]
	\begin{itemize}
		\item Leírás: az [elem] megadja a módosított kapcsoló nevét, míg az [érték] megmutatja, hogy milyen értékre változott az aktuális kapcsoló kimenete.
		\item Megjegyzés: a getValue -all parancsra az összes elemet kilistázza a megadott formában új sor karakterrel elválasztva
	\end{itemize}
\end{itemize}

\textit{step}\newline
Lehetséges kimenetek
\begin{itemize}
	\item szimuláció sikeres; összes elem kilistázása, mintha hívnánk egy getValue -all függvényt
	\begin{itemize}
		\item Leírás: a szimuláció sikeres, amennyiben véges lépésen belül stabilizálódni tud az áramkör.
	\end{itemize}
	\item szimuláció sikertelen: nincs stabil állapot
	\begin{itemize}
		\item Leírás: a szimuláció sikertelen, amennyiben véges lépésen belül nem tud stabilizálódni az áramkör.
	\end{itemize}
\end{itemize}

\section{Összes részletes use-case}

%\begin{figure}[h]
%\begin{center}
%\includegraphics[width=17cm]{chapters/chapter07/example.pdf}
%\caption{x}
%\label{fig:ProtoUseCase}
%\end{center}
%\end{figure}

\usecase{Áramkör betöltése}{Az áramkört leíró fájl betöltése}{Felhasználó}{A loadCircuit parancsot használva betöltheti az
áramkört leíró fájlt, amely a program követelményeinek megfelel}


\usecase{Konfiguráció betöltése}{Egy áramkör konfigurációjának betöltése}{Felhasználó}{A loadSettings paranccsal betölt egy egyedi a konfigurációt 
az áramkörhöz, amely például tartalmazhatja a szekvencia generátorok által kiadott bitsorozatokat vagy a kapcsolók állását.}


\usecase{Konfiguráció mentése}{Áramkör konfigurációjának mentése}{Felhasználó}{A saveSettings parancs kiadásával
 menti az aktuális áramkör konfigurációját.}

\usecase{Kapcsoló kapcsolása}{Kapcsoló állásnak módosítás}{Felhasználó}{Az adott áramkörben a neve alapján azonosított kapcsoló állásának
módosítása a switch parancs használatával.}

\usecase{Szekvenciagenerátor módosítás}{Szekvenciagenerátor bitsorozatának megadása}{Felhasználó}{Az adott áramkörben a neve alapján 
azonosított szekvenciagenerátor által kiadott bitsorozat megadása a setSeqGen paranccsal.}

\usecase{Érték lekérdezése}{Egy, az áramkörben lévő alkatrész értékének lekérdezése}{Felhasználó}{Az adott áramkörben a getValue
parancs használatával a megadott nevű alkatrész értékének lekérdezése.}

\usecase{Áramkör szimulálása}{A betöltött áramkör szimulálása}{Felhasználó}{A step parancs kiadásával szimulálja 
a betöltött áramkört.}

\section{Tesztelési terv}
\comment{A tesztelési tervben definiálni kell, hogy a be- és kimeneti fájlok egybevetésével miként végezhető el a program tesztelése. Meg kell adni teszt forgatókönyveket. Az egyes teszteket elég informálisan, szabad szövegként leírni. Teszt-esetenként egy-öt mondatban. Minden teszthez meg kell adni, hogy mi a célja, a proto mely funkcionalitását, osztályait stb. teszteli. Az alábbi táblázat minden teszt-esethez külön-külön elkészítendő.}

\teszteset{...}{...}{...}

\section{Tesztelést támogató segéd- és fordítóprogramok specifikálása}
\comment{Specifikálni kell a tesztelést támogató segédprogramokat.}

